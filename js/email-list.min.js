/*!
 * Rocklen Institute Website v1.0.0-beta.0 (https://rocklen.institute)
 * Copyright 2013-2019 Start Bootstrap
 * Copyright 2020-2020 SeesePlusPlus LLC
 * All Rights Reserved (https://github.com/SeesePlusPlus/rocklen.institute#copyright-and-license)
 */

"object"!=typeof window.mailtrain&&(window.mailtrain={},function(mt){"use strict";if(!(document.documentMode<=9||"undefined"==typeof XMLHttpRequest)){var forEach=function(e,t,n){for(var o=0;o<e.length;o++)t.call(n,o,e[o])},loadScript=function(exists,url,callback){if(eval(exists))return callback(!0);var scriptTag=document.createElement("script");scriptTag.setAttribute("type","text/javascript"),scriptTag.setAttribute("src",url),void 0!==callback&&(scriptTag.readyState?scriptTag.onreadystatechange=function(){"complete"!==this.readyState&&"loaded"!==this.readyState||callback()}:scriptTag.onload=callback),(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(scriptTag)},serialize=function(e){var t,n=[];if("object"==typeof e&&"FORM"===e.nodeName)for(var o=e.elements.length,r=0;r<o;r++)if((t=e.elements[r]).name&&!t.disabled&&"file"!==t.type&&"reset"!==t.type&&"submit"!==t.type&&"button"!==t.type)if("select-multiple"===t.type)for(var i=e.elements[r].options.length-1;0<=i;i--)t.options[i].selected&&(n[n.length]=encodeURIComponent(t.name)+"="+encodeURIComponent(t.options[i].value));else("checkbox"!==t.type&&"radio"!==t.type||t.checked)&&(n[n.length]=encodeURIComponent(t.name)+"="+encodeURIComponent(t.value));return n.join("&").replace(/%20/g,"+")},getXHR=function(e,t,n,o){var r=new XMLHttpRequest;return r.open(e,t,!0),r.onreadystatechange=function(){if(4===r.readyState){var t;try{t=JSON.parse(r.responseText)}catch(e){t={error:e.message||e}}200!==r.status||t.error?o&&o(t):n&&n(t)}},r},sendForm=function(e,t,n){var o=e.getAttribute("action"),r=getXHR("post",o,t,n);r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.send(serialize(e))},renderWidget=function(o){var t=o.querySelector("form"),e=o.getAttribute("cid"),n=o.getAttribute("mailtrain-url")+"/subscription/"+e+"/subscribe";t.setAttribute("method","POST"),t.setAttribute("action",n);function r(e,t){var n=o.querySelector('div[data-status-template="'+e+'"]').outerHTML;n=t?n.replace("{message}",t):n,i.innerHTML=n}var i=o.querySelector(".status");o.querySelector(".sub-time").value=(new Date).getTime(),window.moment&&window.moment.tz&&(o.querySelector(".tz-detect").value=window.moment.tz.guess()||"");var a=!1;t.addEventListener("submit",function(e){e.preventDefault(),a||(a=!0,r("spinner"),sendForm(t,function(e){a=!1,r("confirm-notice"),t.style.display="none",o.scrollIntoView()},function(e){a=!1,r("error",e.error)}))})};forEach(document.body.querySelectorAll("div[data-mailtrain-subscription-widget]"),function(e,t){renderWidget(t)}),document.addEventListener("DOMContentLoaded",function(){loadScript("window.moment","https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.12.0/moment.min.js",function(e){loadScript("window.moment.tz","https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.3/moment-timezone-with-data.min.js",function(e){window.moment&&window.moment.tz&&forEach(document.body.querySelectorAll(".tz-detect"),function(e,t){t.value=window.moment.tz.guess()||""})})})})}}(window.mailtrain));